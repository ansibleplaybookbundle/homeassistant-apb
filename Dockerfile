FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"IyB2aW06IHNldCBmaWxldHlwZT15YW1sIHNoaWZ0d2lkdGg9MiB0YWJzdG9wPTIgZXhwYW5kdGFi\
IHNtYXJ0aW5kZW50IDoKLS0tCnZlcnNpb246IDEuMApuYW1lOiBob21lYXNzaXN0YW50LWFwYgpk\
ZXNjcmlwdGlvbjogT3BlbiBzb3VyY2UgaG9tZSBhdXRvbWF0aW9uIHRoYXQgcHV0cyBsb2NhbCBj\
b250cm9sIGFuZCBwcml2YWN5IGZpcnN0CmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwK\
bWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IEhvbWUtQXNzaXN0YW50IChBUEIpCiAgaW1hZ2VVcmw6\
IGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9ob21lLWFzc2lzdGFudC9ob21lLWFz\
c2lzdGFudC5pby9uZXh0L3NvdXJjZS9pbWFnZXMvaG9tZS1hc3Npc3RhbnQtbG9nby0yMTY0eDIx\
NjQucG5nCiAgZGVwZW5kZW5jaWVzOgogICAgLSAnZG9ja2VyLmlvL2hvbWVhc3Npc3RhbnQvaG9t\
ZS1hc3Npc3RhbnQnCnBsYW5zOgogIC0gbmFtZTogRXBoZW1lcmFsCiAgICBkZXNjcmlwdGlvbjog\
RGVwbG95IGhvbWUtYXNzaXN0YW50IHdpdGggZXBoZW1lcmFsIHN0b3JhZ2UgKHRlc3RpbmcpCiAg\
ICBmcmVlOiBUcnVlCiAgICBkZWZhdWx0OiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxh\
eU5hbWU6IEVwaGVtZXJhbAogICAgcGFyYW1ldGVyczogW10KICAtIG5hbWU6IFBlcnNpc3RlbnQK\
ICAgIGRlc2NyaXB0aW9uOiBEZXBsb3kgaG9tZS1hc3Npc3RhbnQgd2l0aCBwZXJzaXN0ZW50IHN0\
b3JhZ2UgKHByb2R1Y3Rpb24pCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlz\
cGxheU5hbWU6IFBlcnNpc3RlbnQKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogaGFzc192\
b2x1bWVfc2l6ZQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICBkZWZhdWx0OiAnMUdpJwogICAg\
ICAgIGVudW06IFsnMUdpJywgJzVHaScsICcxMEdpJ10KICAgICAgICB0aXRsZTogSG9tZS1Bc3Np\
c3RhbnQgVm9sdW1lIFNpemUKICAgICAgICByZXF1aXJlZDogdHJ1ZQo="

COPY playbooks/* /opt/apb/project/
COPY . /opt/ansible/roles/homeassistant-apb
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
